{"version":3,"sources":["bounce.js"],"names":["define","langx","geom","styler","transits","transit","bounce","elm","options","done","upAnim","downAnim","start","hide","mode","show","direction","distance","times","speed","duration","easing","ref","motion","i","Deferred","funcs","doAnimate","properties","d","resolve","promise","refValue","css","msize","size","height","width","relativePosition","opacity","push","Math","pow","reduce","prev","curr","index","array","then","this"],"mappings":";;;;;;;AAAAA,OAAO,CACH,sBACA,oBACA,sBACA,aACA,aACF,SAASC,EAAMC,EAAKC,EAAOC,EAASC,GAmGlC,OAAOD,EAASE,OAjGhB,SAAgBC,EAAKC,EAASC,GAC1B,IAAIC,EAAQC,EAMRC,EAHAC,EAAgB,UAATC,EADAN,EAAQM,MAEfC,EAAgB,SAATD,EACPE,EAAYR,EAAQQ,WAAa,KAEjCC,EAAWT,EAAQS,SACnBC,EAAQV,EAAQU,OAAS,EAIzBC,EAAQX,EAAQY,UADA,EAARF,GAAcH,GAAQF,EAAO,EAAI,IAEzCQ,EAASb,EAAQa,OAGjBC,EAAsB,OAAdN,GAAoC,SAAdA,EAAyB,MAAQ,OAC/DO,EAAyB,OAAdP,GAAoC,SAAdA,EACjCQ,EAAI,EAIJC,EAAWxB,EAAMwB,SACjBC,EAAQ,GAiCZ,SAASC,EAAUpB,EAAIqB,EAAYR,EAAUC,GACzC,OAAO,WACH,IAAIQ,EAAI,IAAIJ,EAKZ,OAHApB,EAAQE,EAAIqB,EAAYR,EAAUC,EAAQ,WACtCQ,EAAEC,QAAQ,CACd,CAAC,EACMD,EAAEE,OAEb,CACJ,CAGA,IA5CAC,EAAW7B,EAAO8B,IAAI1B,EAAIe,CAAI,EAGxBL,IACEiB,EAAQhC,EAAKiC,KAAK5B,CAAG,EACzBU,GAAoB,OAARK,EAAgBY,EAAME,OAASF,EAAMG,OAAS,GAG9DzB,EAAQV,EAAKoC,iBAAiB/B,CAAG,EAAEe,GAE9BP,KACDJ,EAAW,CAAE4B,QAAS,CAAE,GACdjB,GAAQU,EAIlB7B,EAAO8B,IAAI1B,EAAK,UAAW,CAAE,EAC7BJ,EAAO8B,IAAI1B,EAAKe,EAAKV,GAASW,EAAqB,EAAZ,CAACN,EAA0B,EAAXA,EAAc,EAErES,EAAMc,KAAKb,EAAUpB,EAAII,EAAUQ,EAAOE,CAAM,CAAC,GAIhDR,IACDI,GAAsBwB,KAAKC,IAAK,EAAGxB,EAAQ,CAAE,IAGjDP,EAAW,IACDW,GAAQU,EAgBVR,EAAIN,EAAOM,CAAC,IAChBd,EAAS,IACDY,GAAQV,GAAUW,EAAS,CAACN,EAAWA,GAE/CS,EAAMc,KAAKb,EAAUpB,EAAIG,EAAQS,EAAOE,CAAM,CAAC,EAE/CK,EAAMc,KAAKb,EAAUpB,EAAII,EAAUQ,EAAOE,CAAM,CAAC,EAEjDJ,EAAWJ,EAAkB,EAAXI,EAAeA,EAAW,EAgBhD,OAZKJ,KACDH,EAAS,CAAE6B,QAAS,CAAE,GACdjB,GAAQV,GAAUW,EAAS,CAAC,EAAIN,EAAWA,GAEnDS,EAAMc,KAAKb,EAAUpB,EAAIG,EAAQS,EAAOE,CAAO,CAAC,GAGpDK,EAAMc,KAAK/B,CAAI,EACfiB,EAAMiB,OAAO,SAASC,EAAMC,EAAMC,EAAOC,GACrC,OAAOH,EAAKI,KAAKH,CAAI,CACzB,EAAGpB,EAASK,QAAQ,CAAC,EAEdmB,IACX,CAGJ,CAAC","file":"../bounce.js","sourcesContent":["define([\r\n    \"skylark-langx/langx\",\r\n    \"skylark-domx-geom\",\r\n    \"skylark-domx-styler\",\r\n    \"./transits\",\r\n    \"./transit\"\r\n],function(langx,geom,styler,transits,transit) {\r\n\r\n    function bounce(elm, options, done ) {\r\n        var upAnim, downAnim, refValue,\r\n            // Defaults:\r\n            mode = options.mode,\r\n            hide = mode === \"hide\",\r\n            show = mode === \"show\",\r\n            direction = options.direction || \"up\",\r\n            start,\r\n            distance = options.distance,\r\n            times = options.times || 5,\r\n\r\n            // Number of internal animations\r\n            anims = times * 2 + ( show || hide ? 1 : 0 ),\r\n            speed = options.duration / anims,\r\n            easing = options.easing,\r\n\r\n            // Utility:\r\n            ref = ( direction === \"up\" || direction === \"down\" ) ? \"top\" : \"left\",\r\n            motion = ( direction === \"up\" || direction === \"left\" ),\r\n            i = 0;\r\n\r\n        //createPlaceholder(elm);\r\n\r\n        var Deferred = langx.Deferred;\r\n        var funcs = [];\r\n\r\n        refValue = styler.css(elm,ref );\r\n\r\n        // Default distance for the BIGGEST bounce is the outer Distance / 3\r\n        if ( !distance ) {\r\n            var msize = geom.size(elm);\r\n            distance = (ref === \"top\" ? msize.height : msize.width) / 3;\r\n        }\r\n\r\n        start = geom.relativePosition(elm)[ref];\r\n\r\n        if ( show ) {\r\n            downAnim = { opacity: 1 };\r\n            downAnim[ ref ] = refValue;\r\n\r\n            // If we are showing, force opacity 0 and set the initial position\r\n            // then do the \"first\" animation\r\n            styler.css(elm, \"opacity\", 0 );\r\n            styler.css(elm, ref, start + (motion ? -distance * 2 : distance * 2 ));\r\n\r\n            funcs.push(doAnimate(elm,downAnim, speed, easing));\r\n        }\r\n\r\n        // Start at the smallest distance if we are hiding\r\n        if ( hide ) {\r\n            distance = distance / Math.pow( 2, times - 1 );\r\n        }\r\n\r\n        downAnim = {};\r\n        downAnim[ ref ] = refValue;\r\n\r\n\r\n        function doAnimate(elm,properties, duration, easing) {\r\n            return function() {\r\n                var d = new Deferred();\r\n\r\n                transit(elm,properties, duration, easing ,function(){\r\n                    d.resolve();\r\n                });\r\n                return d.promise;\r\n\r\n            }\r\n        }\r\n\r\n        // Bounces up/down/left/right then back to 0 -- times * 2 animations happen here\r\n        for ( ; i < times; i++ ) {\r\n            upAnim = {};\r\n            upAnim[ ref ] = start + ( motion ? -distance : distance) ;\r\n\r\n            funcs.push(doAnimate(elm,upAnim, speed, easing));\r\n\r\n            funcs.push(doAnimate(elm,downAnim, speed, easing));\r\n\r\n            distance = hide ? distance * 2 : distance / 2;\r\n        }\r\n\r\n        // Last Bounce when Hiding\r\n        if ( hide ) {\r\n            upAnim = { opacity: 0 };\r\n            upAnim[ ref ] = start + ( motion ? -1 * distance : distance) ;\r\n\r\n            funcs.push(doAnimate(elm,upAnim, speed, easing ));\r\n        }\r\n\r\n        funcs.push(done);\r\n        funcs.reduce(function(prev, curr, index, array) {\r\n            return prev.then(curr);\r\n        }, Deferred.resolve());\r\n\r\n        return this;\r\n    } \r\n\r\n    return transits.bounce = bounce;\r\n});"]}